# AITESTDOC - Internal File Management System

ระบบจัดการไฟล์ภายในบริษัทสำหรับอัปโหลดไฟล์ไปยัง Google Drive และสร้าง QR Code สำหรับการเข้าถึงไฟล์

## คุณสมบัติ

- ✅ อัปโหลดไฟล์ PDF, DOC, DOCX, PNG, JPEG, JPG ไปยัง Google Drive
- ✅ สร้าง QR Code พร้อมโลโก้บริษัทตรงกลางสำหรับเข้าถึงไฟล์
- ✅ รวมหลายไฟล์เป็น PDF เดียวพร้อม QR Code เดียว
- ✅ อินเทอร์เฟซที่ทันสมัยและใช้งานง่าย
- ✅ ระบบ Drag & Drop สำหรับอัปโหลดไฟล์
- ✅ ประวัติการอัปโหลดไฟล์ล่าสุด
- ✅ คัดลอกลิงก์ไฟล์
- ✅ ดาวน์โหลด QR Code เป็นไฟล์ PNG
- ✅ สแกนหาอีเมลในไฟล์ที่อัปโหลดและแสดงใน Console Log

## การติดตั้ง

### 1. ติดตั้ง Dependencies

```bash
npm install
```

### 2. ตั้งค่า Google Drive API

1. ไฟล์ `client_secret_537558187339-g9ua637qvrh3e2idbi35g58ll5oioct3.apps.googleusercontent.com.json` ได้ถูกรวมไว้แล้ว
2. เมื่อรันแอปพลิเคชันครั้งแรก คุณจะต้องอนุญาตการเข้าถึง Google Drive

### 3. เริ่มต้นใช้งาน

```bash
npm start
```

หรือสำหรับการพัฒนา:

```bash
npm run dev
```

แอปพลิเคชันจะทำงานที่ `http://localhost:3000`

## การใช้งาน

### การอนุญาต Google Drive (ครั้งแรกเท่านั้น)

1. เมื่อเปิดแอปพลิเคชันครั้งแรก จะมีป๊อปอัพขอการอนุญาต
2. คลิก "อนุญาต Google Drive"
3. เข้าสู่ระบบ Google และอนุญาตการเข้าถึง
4. กลับมาที่แอปพลิเคชัน

### การอัปโหลดไฟล์

1. **เลือกไฟล์**: คลิก "เลือกไฟล์" หรือลากไฟล์มาวางในพื้นที่
2. **เลือกโหมด**:
   - **อัปโหลดแยกไฟล์**: แต่ละไฟล์จะได้ QR Code แยกกัน
   - **รวมไฟล์เป็น PDF เดียว**: หลายไฟล์จะถูกรวมเป็น PDF เดียวพร้อม QR Code เดียว (ชื่อไฟล์: testreport-วันเดือนปี.pdf)
3. **อัปโหลด**: คลิก "อัปโหลดไฟล์"
4. **ดู QR Code**: QR Code จะแสดงพร้อมลิงก์สำหรับดูและดาวน์โหลดไฟล์

### ไฟล์ที่รองรับ

- **เอกสาร**: PDF, DOC, DOCX
- **รูปภาพ**: PNG, JPEG, JPG
- **ขนาดไฟล์สูงสุด**: 50MB ต่อไฟล์

## โครงสร้างโปรเจค

```
AITESTDOC/
├── public/
│   ├── index.html          # หน้าเว็บหลัก
│   ├── app.js             # JavaScript สำหรับ Frontend
│   └── WebMeter-logo.png  # โลโก้บริษัท
├── uploads/               # โฟลเดอร์ชั่วคราวสำหรับไฟล์
├── server.js             # เซิร์ฟเวอร์ Node.js
├── package.json          # Dependencies
├── client_secret_*.json  # Google API Credentials
├── token.json           # Google OAuth Token (สร้างอัตโนมัติ)
└── README.md            # คู่มือนี้
```

## API Endpoints

- `GET /` - หน้าเว็บหลัก
- `POST /upload` - อัปโหลดไฟล์
- `GET /auth-status` - ตรวจสอบสถานะการอนุญาต
- `GET /oauth/callback` - Callback สำหรับ OAuth

## การแก้ไขปัญหา

### ปัญหาการอนุญาต
- ลบไฟล์ `token.json` และเริ่มการอนุญาตใหม่
- ตรวจสอบว่า Google API Credentials ถูกต้อง

### ปัญหาการอัปโหลด
- ตรวจสอบขนาดไฟล์ (ไม่เกิน 50MB)
- ตรวจสอบประเภทไฟล์ที่รองรับ
- ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต

### ปัญหา QR Code
- QR Code จะสร้างหลังจากอัปโหลดสำเร็จ
- ตรวจสอบว่าไฟล์ถูกแชร์เป็น Public ใน Google Drive

## ความปลอดภัย

- ไฟล์จะถูกลบออกจากเซิร์ฟเวอร์หลังอัปโหลดเสร็จ
- ใช้ OAuth 2.0 สำหรับการเข้าถึง Google Drive
- ไฟล์ใน Google Drive จะถูกตั้งค่าให้เป็น Public สำหรับการเข้าถึงผ่าน QR Code

## การพัฒนาเพิ่มเติม

หากต้องการเพิ่มคุณสมบัติ:

1. แก้ไข `server.js` สำหรับ Backend
2. แก้ไข `public/app.js` สำหรับ Frontend
3. แก้ไข `public/index.html` สำหรับ UI

## ข้อมูลเพิ่มเติม

- Node.js version: 14.0.0 หรือสูงกว่า
- ต้องการการเชื่อมต่ออินเทอร์เน็ตสำหรับ Google Drive API
- แนะนำให้ใช้ในระบบภายในบริษัทเท่านั้น
